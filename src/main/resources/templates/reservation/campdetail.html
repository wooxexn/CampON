<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Title</title>

</head>
<body>

<h2>예약 추가</h2>

<form th:action="@{/campdetail}" method="post" onsubmit="return checkValue()">

  <!-- 입실일 입력 -->
  <label for="check_in_date">입실일:</label>
  <input type="date" id="check_in_date" name="check_in_date" required /> <br>

  <!-- 퇴실일 입력 -->
  <label for="check_out_date">퇴실일:</label>
  <input type="date" id="check_out_date" name="check_out_date" required /> <br>

  <input type="hidden" id="camp_id" name="camp_id" value="1" required>


  <button type="submit">확인</button>

  <script>
    function checkValue() {
      const checkInDate = document.getElementById('check_in_date').value;
      const checkOutDate = document.getElementById('check_out_date').value;

      // AJAX 요청을 보내는 부분
        fetch('/campdetail', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: `check_in_date=${checkInDate}&check_out_date=${checkOutDate}&camp_id=1`
  })
  .then(response => {
  if (response.ok) {
      return response.json();  // 응답이 JSON이면 파싱
    }
    throw new Error('네트워크 응답이 실패했습니다');
  })
  .then(data => {
    console.log(data);  // 서버 응답 확인
    // 예약된 캠핑장 목록을 화면에 출력
    const reservedCampDiv = document.querySelector('#reservedCamp');
    if (data && data.length > 0) {
      let html = '<h3>예약 가능한 캠핑장</h3><ul>';
      data.forEach(reservation => {
        html += `<li>캠핑장 ID: ${reservation.camp_id}, 입실일: ${reservation.check_in_date}, 퇴실일: ${reservation.check_out_date}</li>`;
      });
      html += '</ul>';
      reservedCampDiv.innerHTML = html;
    } else {
      reservedCampDiv.innerHTML = '<p>예약 가능한 캠핑장이 없습니다.</p>';
    }
  });

  return false; // 폼 기본 제출을 막음
}
  </script>

  <!-- 예약된 캠핑장을 출력할 곳 -->
  <div id="reservedCamp"></div>




</form>

</body>
</html>